import{j as e,W as C,r as v,y}from"./app-BoMIvddg.js";import{a as w}from"./index-D5yv4rSE.js";import"./iconBase-C-E2QR4l.js";function I({children:t}){return e.jsx("div",{id:"form-container",children:t})}function T({onSortChange:t,value:a}){return e.jsxs("div",{id:"sort-by-wrapper",children:[e.jsx("div",{children:"sort by"}),e.jsxs("select",{name:"sortBy",id:"sort-by",defaultValue:a,onChange:l=>t(l.target.value),children:[e.jsx("option",{value:"default",children:"default"}),e.jsx("option",{value:"alphabetical",children:"alphabetical"})]})]})}function k({onSearchChange:t}){return e.jsxs("div",{id:"search",children:[e.jsx("label",{htmlFor:"search-input",children:"search"}),e.jsx("input",{id:"search-input",type:"text",placeholder:"search a name...",onChange:a=>t(a.target.value)})]})}function B({setModalVisibility:t}){return e.jsx("div",{className:"add-btn-wrapper",children:e.jsx("div",{role:"button",id:"add-btn",onClick:a=>t(!0),children:"add contact +"})})}function A(){return e.jsxs("div",{id:"header-contacts",children:[e.jsx("div",{id:"header-name",children:"name"}),e.jsx("div",{id:"header-address",children:"address"}),e.jsx("div",{id:"header-number",children:"tel. number"}),e.jsx("div",{id:"header-email",children:"email"}),e.jsx("div",{children:"relationship"})]})}const O={background:"#52B282",padding:"3px 6px",display:"inline-block",color:"#ffffff",borderRadius:"20px"},F={width:"100px",display:"flex",alignItems:"center",justifyContent:"center",margin:"0px 0px 0px 10px"};function N({details:t,onItemSelected:a,handleDeleteItem:l}){const{name:s,lastname:h,address:d,number:m,email:j,relationship:n,id:o}=t;return e.jsx(e.Fragment,{children:e.jsxs("div",{id:"cell",children:[e.jsxs("div",{id:"user-name",children:[s," ",h]}),e.jsx("div",{id:"user-address",children:d}),e.jsx("div",{id:"user-number",children:m}),e.jsx("div",{id:"user-email",children:j}),e.jsx("div",{style:F,id:"user-relationship",children:e.jsx("div",{style:O,children:n})}),e.jsx("div",{id:"edit",onClick:u=>a(o),children:"edit"}),e.jsx("div",{id:"delete",onClick:u=>{l(o),console.log("selected",t)},children:"delete"})]})})}function S({handleModalVisibility:t,defaultValue:a,headerText:l,submitText:s,token:h,userID:d,requestAndSaveLocalStartingData:m}){const j={name:null,lastname:null,address:null,email:null,number:null,relationship:"friend"},{data:n,setData:o}=C(a??j),[u,g]=v.useState(!1);function b(r){r.preventDefault();const f=n.name&&n.lastname&&n.address&&n.email&&n.number&&n.relationship;console.log(n),a&&f?(fetch("/api/update",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+h},body:JSON.stringify({id:a.id,...n})}).then(p=>{m(d)}).catch(p=>console.error(p)),t(!1)):f?(fetch("/api/add",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+h},body:JSON.stringify({userID:d,...n})}).then(p=>{p.status===200&&m(d)}).catch(p=>console.error(p)),t(!1)):g(!0)}return console.log(d),e.jsx("div",{id:"modal-background",children:e.jsx("form",{onSubmit:b,children:e.jsxs("div",{id:"modal-container",children:[e.jsx(E,{handleModalVisibility:t,headerText:l}),e.jsxs("div",{id:"modal-body",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"first-name",children:"first name"}),e.jsx("input",{name:"first-name",type:"text",placeholder:"Juan",defaultValue:n.name,onChange:r=>{o("name",r.target.value)}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"last-name",children:"last name"}),e.jsx("input",{name:"last-name",type:"text",placeholder:"Dela cruz",defaultValue:n.lastname,onChange:r=>{o("lastname",r.target.value)}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"address",children:"address"}),e.jsx("input",{name:"address",type:"text",placeholder:"#17 Sampaloc Street...",defaultValue:n.address,onChange:r=>{o("address",r.target.value)}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",children:"email"}),e.jsx("input",{name:"email",type:"text",placeholder:"juan123@gmail.com",defaultValue:n.email,onChange:r=>{o("email",r.target.value)}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tel",children:"phone number"}),e.jsx("input",{name:"tel",type:"number",placeholder:"+63123456789",defaultValue:n.number,onChange:r=>{o("number",r.target.value)}})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"relationship",children:"relationship"}),e.jsxs("select",{name:"relationship",defaultValue:n.relationship,onChange:r=>{o("relationship",r.target.value)},children:[e.jsx("option",{value:"friend",children:"friend"}),e.jsx("option",{value:"family",children:"family"}),e.jsx("option",{value:"classmate",children:"classmate"}),e.jsx("option",{value:"neighboor",children:"neighboor"}),e.jsx("option",{value:"teacher",children:"teacher"})]})]}),u&&e.jsx("div",{id:"error",style:{color:"red"},children:"please complete the form."})]}),e.jsx(J,{handleModalVisibility:t,submitText:s})]})})})}function E({handleModalVisibility:t,headerText:a}){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{id:"close-modal-wrapper",children:[" ",e.jsx("div",{id:"close-modal",onClick:l=>t(!1),children:"âœ•"})]}),e.jsx("div",{id:"modal-header",children:a})]})}function J({handleModalVisibility:t,submitText:a}){return e.jsxs("div",{id:"modal-footer",children:[e.jsx("button",{id:"btn-cancle",onClick:l=>t(!1),children:"cancel"}),e.jsx("button",{type:"submit",id:"btn-submit",children:a})]})}function M({data:t}){const a=new Date;return e.jsxs("div",{id:"footer-desc",children:["You have a total of ",t.length," contacts as of today"," ",a.toDateString(),"."]})}function z({handleModalVisibility:t,data:a,onItemSelected:l,handleDeleteItem:s,startingData:h,userID:d,token:m,userName:j}){let n=a;const[o,u]=v.useState("default"),[g,b]=v.useState("");function r(){const i=[...n].sort((x,D)=>x.name.localeCompare(D.name));return console.log(i),i}function f(i){console.log(i),u(i)}function p(i){b(i)}g&&(n=[...n].filter(x=>(x.name+x.lastname).toLowerCase().includes(g))),o==="alphabetical"&&(n=r());function c(){fetch("/api/logout",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+m},body:JSON.stringify({userID:d})}).then(i=>{i.status===200&&(localStorage.removeItem("rawToken"),localStorage.removeItem("userID"),localStorage.removeItem("userName"),localStorage.removeItem("startingData"),y.visit("/"))}).catch(i=>console.error(i))}return console.log(d,m),e.jsxs("div",{id:"main",children:[e.jsxs("div",{id:"workplace-header",children:[e.jsxs("div",{id:"workplace-welcome",children:["Welcome, ",j,"!"]}),e.jsxs("div",{role:"button",id:"workplace-logout",onClick:c,style:{display:"inline"},children:["logout ",e.jsx(w,{size:20,style:{display:"inline"}})]})]}),e.jsxs(I,{children:[e.jsx(k,{onSearchChange:p}),e.jsx(T,{onSortChange:f,value:o}),e.jsx(B,{setModalVisibility:t})]}),e.jsx(L,{data:n,boardData:!0,onItemSelected:l,handleDeleteItem:s}),e.jsx(M,{data:h})]})}function L({data:t,onItemSelected:a,handleDeleteItem:l}){return e.jsx("div",{id:"board-body",children:e.jsxs("div",{style:{display:"inline-block"},children:[e.jsx(A,{}),e.jsx("div",{id:"cells-container",children:t.map((s,h)=>e.jsx(N,{details:s,onItemSelected:a,handleDeleteItem:l},h))})]})})}function W(){let t,a,l,s;t=JSON.parse(localStorage.getItem("startingData")),a=localStorage.getItem("rawToken"),l=localStorage.getItem("userID"),s=localStorage.getItem("userName"),t&&a&&l&&s||y.visit("login"),console.log(t);const[h,d]=v.useState(!1),[m,j]=v.useState(!1),{data:n,setData:o}=C(),[u]=v.useState(a);function g(c){o(null),d(c)}function b(c){j(c)}function r(c){t.forEach((i,x)=>{i.id===c&&(o(i),j(!0))})}function f(c){fetch("/api/userdata",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a},body:JSON.stringify({userID:c})}).then(i=>i.json()).then(i=>{console.log(i),localStorage.setItem("startingData",JSON.stringify(i)),y.visit("workplace",{preserveScroll:!0})})}function p(c){confirm("Are you sure you want to delete the selected contact?")&&fetch("/api/delete",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+u},body:JSON.stringify({id:c})}).then(x=>{x.status===200&&f(l)}).catch(x=>console.error(x))}return e.jsxs(e.Fragment,{children:[h&&e.jsx(S,{handleModalVisibility:g,headerText:"Add Contact",submitText:"submit",token:u,userID:l,requestAndSaveLocalStartingData:f}),m&&e.jsx(S,{handleModalVisibility:b,defaultValue:n,headerText:"Update Contact",submitText:"update",token:u,userID:l,requestAndSaveLocalStartingData:f}),e.jsx(z,{handleModalVisibility:g,data:t,token:u,onItemSelected:r,handleDeleteItem:p,startingData:t,userID:l,userName:s})]})}export{W as default};
