import{y as a,W as T,r as i,j as e}from"./app-BM66FXAr.js";import{a as E}from"./index-DrlKPOjZ.js";import{G as P}from"./iconBase-DXZzP0jo.js";import{I as z}from"./index-BfNGqDGZ.js";import{B as C,a as N}from"./index-DVzZXOfA.js";function M(t){return P({attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"},child:[]}]})(t)}function G(){let t,n,l,d;t=JSON.parse(localStorage.getItem("startingData")),n=localStorage.getItem("rawToken"),l=localStorage.getItem("userID"),d=localStorage.getItem("userName"),t&&n&&l&&d&&a.visit("workplace");const{data:c,setData:g}=T(),[p,m]=i.useState(),[h,b]=i.useState("password"),[k,u]=i.useState(),[I,x]=i.useState();function L(r){r.preventDefault(),fetch("/api/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(c)}).then(s=>(console.log(s),s.status!==200&&m(s.statusText),s.json())).then(s=>{const{errors:o}=s;if(o){const{email:f,password:S}=o;console.log(f,S),u(f),x(S)}console.log(o);const{token:D,user:j,startingData:w}=s,{name:y}=j,{id:v}=j;console.log(v),console.log(s),console.log(y),console.log(w),localStorage.setItem("startingData",JSON.stringify(w)),localStorage.setItem("userName",y),localStorage.setItem("rawToken",D),localStorage.setItem("userID",v),a.visit("workplace")}).catch(s=>{m("wrong email or password.")}),console.log(c)}return e.jsxs("div",{id:"login-wrapper",children:[e.jsx("div",{id:"bg-register",children:e.jsxs("div",{id:"register-container",children:[e.jsx("div",{id:"register-header",children:"Login"}),e.jsx("form",{onSubmit:L,children:e.jsxs("div",{id:"register-body",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"email",children:["email"," ",e.jsx("span",{children:e.jsx(M,{size:17,style:{display:"inline",color:"#444444"}})})]}),e.jsx("input",{name:"email",onChange:r=>{g("email",r.target.value),u(null)},style:k?{border:"1px solid red"}:{}})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"password",children:["password"," ",e.jsx("span",{children:e.jsx(E,{size:17,style:{display:"inline",color:"#444444"}})})]}),e.jsx("input",{name:"password",onChange:r=>{g("password",r.target.value),x(null)},type:h,style:I?{border:"1px solid red"}:{}}),e.jsxs("div",{role:"button",id:"toggle-password",onClick:r=>{b(s=>s==="password"?"text":"password")},children:[" ",e.jsx("span",{}),h==="password"?e.jsxs(e.Fragment,{children:[" ",e.jsx(C,{size:14,style:{display:"inline",marginRight:"5px"}})," ","show"]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{size:14,style:{display:"inline",marginRight:"5px"}}),"hide"]}),"  "," password"]})]}),p&&e.jsx("div",{style:{color:"red"},children:p}),e.jsx("div",{id:"btn-container",children:e.jsx("button",{type:"submit",id:"submit-register",children:"submit"})}),e.jsx("div",{role:"button",id:"register-text",onClick:r=>{a.visit("register")},children:"register"})]})})]})}),e.jsx("div",{id:"login-img",children:e.jsxs("div",{id:"login-notice",children:["Please"," ",e.jsx("div",{style:{display:"block"},children:e.jsxs("span",{style:{display:"inline"},children:["login",e.jsx(z,{size:70,style:{display:"inline"}})]})})," ","to continue."]})})]})}export{G as default};
